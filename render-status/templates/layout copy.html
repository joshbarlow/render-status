<!DOCTYPE html>

<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, width=device-width">

        <link href="/static/favicon.ico" rel="icon">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">

        <title>Render Status</title>

        <script>

            function httpGet(theUrl)
            {
              let xmlHttp = new XMLHttpRequest();
              xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
              xmlHttp.send( null );
              return xmlHttp.responseText;
            }

            // Toggles visibility of greeting
            function increment()
            {

              let jsonResult = JSON.parse(httpGet("/status"));

              console.log(jsonResult);

              let x = document.getElementsByClassName("progress-bar");
              let i;
              for (i = 0; i < x.length; i++) {

                let newPercent = jsonResult[x[i].getAttribute("name")];
                console.log(x[i].getAttribute("name"));

                let rand = Math.floor(Math.random() * 100);
                x[i].style.width = newPercent.toString() + "%" ;
                x[i].innerHTML = newPercent.toString() + "%" ;
                if (newPercent.toString() == '100') {
                  x[i].className = "progress-bar bg-success";
                } else {
                  x[i].className = "progress-bar progress-bar-striped progress-bar-animated";
                }

              }
            }

            window.setInterval(increment, 1000);

        </script>

    </head>
    <body>
      <!-- As a heading -->
      <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
          <span class="navbar-brand mb-0 h1">Render Status</span>
        </div>
      </nav>

      <div id='cardContainter' style="width: 100%;">
      </div>

      <template id="jobcard">
        <div class="card" style="width: 100%;">
          <div class="card-body">
            <h5 class="card-title"></h5>
            <div class="progress">
              <div name = "" class="progress-bar" role="progressbar" style="width: 10%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">10%</div>
            </div>
          </div>
        </div>
      </template>

      {% block main %}{% endblock %}

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>

    </body>
</html>
